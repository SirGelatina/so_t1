#include "header.h"

const int ProgramDatabase[][MEMSIZE] = {

	{		// 0
		0b00000010011100110100100000100000, // add $t1, $s3, $s3
		0b11111111111111111111111111111111
		//000000 10011 10011 01001 00000 100000
	},
	{		// 1	
		0b10101111101100110000000000000000, // sw $s3, 0($sp)
		0b10001111101010000000000000000000, // lw $t0, 0($sp)
		0b11111111111111111111111111111111
		//100011 11101 01000 0000000000000000 (LW)
	},
	{		// 2
		0b00010001000101010000000000000001, // beq $t0, $s5, exit
		0b00000010011100110100100000100000,
		0b00000010011100110100100000100010,
		0b00000010011100110100100000100000,
		0b11111111111111111111111111111111
		//000100 01000 10101 0000000000000001
	},
	{		// 3
		0b00001000000000000000000000000010, // j add
		0b00000010011100110100000000100010, // sub $t0, $s3, $s3
		0b00000010011100110100100000100000, // add $t1, $s3, $s3
		0b11111111111111111111111111111111
		//000010 00000000000000000000000000 (J)
	},
	{		// 4
		0b00000010011100110100000000100010, // sub $t1, $s3, $s3
		0b11111111111111111111111111111111
		//000000 10011 10011 01001 00000 100010
	},
	{		// 5
		0b10101111101100110000000000000000, // sw $s3, 0($sp)
		0b11111111111111111111111111111111
		//101011 11101 10011 0000000000000000
	},
	{		// 6
		0b00000000110001110010100000101010, // slt $a1, $a2, $a3
		0b11111111111111111111111111111111
		//000000 00100 00101 00110 00000 101010
	},
	{		// 7
		0b00000001111000000111000000100100, // and $t6, $t7, $zero 
		0b11111111111111111111111111111111
		//000000 01110 01111 01101 00000 100100
	},
	{		// 8
		0b00000001111001100111000000100101,  // or $t6, $t7, $a2
		0b11111111111111111111111111111111
		//000000 10110 10111 10101 00000 100101
	},
	{	// 9, Fatorial

		// # - 			a0 = entrada
		// # - 			t2 = 1
		// # - 			t3 = 100

		// 0  - 		sw a0, 0(sp)
		// 4  - 		lw t0, 0(sp) 
		// 8  -			add t1, t0, zero
		// 12 -	fat:	beq t1, t2, fim1
		// 16  - 		sub t1 t1 t2

		// 20  - mul: 	beq t1, t2, fim2 
		// 24  - 	 	add t0 t0 t7
		// 28  - 	 	sub t1 t1 t2
		// 32 - 	 	j mul
		// 36 - fim2: 	j fat

		// 40 - fim1:	slt v1 t0 t4
		// 44 -			or v0, t0, zero  
		// 48 -			and t4 t4 zero   

		// # -          v0 = saida do fatorial
		// # -          v1 = 1 se v0 < 100 e 0 c.c.

		/*0 */ 0b10101111101001000000000000000000,
		/*4 */ 0b10001111101010000000000000000000,
		/*8 */ 0b00000001000000000100100000100000,
		/*12*/ //0b00010001000101010000000000000001,
		/*16*/ 0b00000001001010100100100000100010,
		/*20*/ //0b00000001000010100111100000100101,
		/*24*/ 0b00000001000011110100000000100000,
		/*28*/ 0b00000001001010100100100000100010,
		/*32*/ //0b00000001011010100101100000100010,
		/*36*/ //0b00001000000000000000000000000110,
		/*40*/ 0b00000001000011000001100000101010,
		/*44*/ 0b00000001000000000001000000100101,
		/*48*/ 0b00000001100000000110000000100100,	
		/*52*/ 0b11111111111111111111111111111111
		/*56*/

	},
	{
		//10, Multiplicacao

		// # - 			t3 = b
		// # - 			t2 = 1
		// # - 			t0 = t7 = a

		// 0  - mul: 	beq t3, t2, fim2 
		// 4  - 	 	add t0 t0 t7
		// 8  - 	 	sub t3 t3 t2
		// 12 - 	 	j mul
		// 16 - fim:

		/*0 */ 0b00010001011010100000000000000011,
		/*4 */ 0b00000001000011110100000000100000,
		/*8 */ 0b00000001011010100101100000100010,
		/*12*/ 0b00001000000000000000000000000000,
		/*16*/ 0b11111111111111111111111111111111

	}
};

/*------------------------------------------------------------------------------------------------*/ 
//	         CorrespondÃªncia entre registradores e posicao no vetor 'reg' de File_register     
//
//     ||     $zero | 0     ||     $t0   | 8     ||     $s0   | 16    ||     $t8   | 24    ||              
//     ||     $at   | 1     ||     $t1   | 9     ||     $s1   | 17    ||     $t9   | 25    || 
//     ||     $v0   | 2     ||	   $t2   | 10    ||     $s2   | 18    ||     $k0   | 26    || 
//     ||     $v1   | 3     ||     $t3   | 11    ||     $s3   | 19    ||     $k1   | 27    || 
//     ||     $a0   | 4     ||     $t4   | 12    ||     $s4   | 20    ||     $gp   | 28    || 
//     ||     $a1   | 5     ||     $t5   | 13    ||     $s5   | 21    ||     $sp   | 29    || 
//     ||     $a2   | 6     ||     $t6   | 14    ||     $s6   | 22    ||     $fp   | 30    || 
//     ||     $a3   | 7     ||     $t7   | 15    ||     $s7   | 23    ||     $ra   | 31    || 
// 	  	    	
/*------------------------------------------------------------------------------------------------*/

void RegisterFile0(int * regfile){
	regfile[6]	= 1; /* a2 = 1 */	
	regfile[7]	= 2; /* a3 = 2 */	
	regfile[8]	= 3; /* t0 = 3 */	
	regfile[14]	= 4; /* t6 = 4 */	
	regfile[15]	= 5; /* t7 = 5 */	
	regfile[19]	= 6; /* s3 = 6 */	
	regfile[21]	= 3; /* s5 = 3 */	
	regfile[22]	= 8; /* s6 = 8 */	
	regfile[23]	= 9; /* s7 = 9 */
}

void RegisterFile1(int * regfile){
	regfile[4]	= 4; 			/* a0 = entrada */
	regfile[9]	= regfile[4]; 	/* t1 = entrada aux */
	regfile[10]	= 1; 			/* t2 = 1 */
	regfile[12]	= 100; 			/* t4 = 100 */
}

void RegisterFile2(int * regfile){
	// a = a*b
	regfile[8]	= 11; // a		
	regfile[11]	= 10; // b
	regfile[10]	= 1; 			
	regfile[15]	= regfile[8]; 			
}

void (* const InitRegister[])(int *) = {
	RegisterFile0,
	RegisterFile1,
	RegisterFile2
};
